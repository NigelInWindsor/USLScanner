// CopyUtPage.cpp : implementation file
//

#include "stdafx.h"
#include "uslscanner.h"
#include "CopyUtPage.h"

#ifdef _DEBUG
#define new DEBUG_NEW
#undef THIS_FILE
static char THIS_FILE[] = __FILE__;
#endif

/////////////////////////////////////////////////////////////////////////////
// CCopyUtPage property page

IMPLEMENT_DYNCREATE(CCopyUtPage, CPropertyPage)

CCopyUtPage::CCopyUtPage() : CPropertyPage(CCopyUtPage::IDD)
{
	//{{AFX_DATA_INIT(CCopyUtPage)
		// NOTE: the ClassWizard will add member initialization here
	//}}AFX_DATA_INIT
	m_bDlgCreated = false;
}

CCopyUtPage::~CCopyUtPage()
{
}

void CCopyUtPage::DoDataExchange(CDataExchange* pDX)
{
	CPropertyPage::DoDataExchange(pDX);
	//{{AFX_DATA_MAP(CCopyUtPage)
	DDX_Control(pDX, IDC_LIST_UT_VARIABLES, m_listUtVariables);
	//}}AFX_DATA_MAP

}


BEGIN_MESSAGE_MAP(CCopyUtPage, CPropertyPage)
	//{{AFX_MSG_MAP(CCopyUtPage)
	ON_LBN_SELCHANGE(IDC_LIST_UT_VARIABLES, OnSelchangeListUtVariables)
	//}}AFX_MSG_MAP
	ON_CLBN_CHKCHANGE(IDC_LIST_UT_VARIABLES, OnCheckChangeListUtVariables)
END_MESSAGE_MAP()

/////////////////////////////////////////////////////////////////////////////
// CCopyUtPage message handlers

BOOL CCopyUtPage::OnInitDialog() 
{
	CPropertyPage::OnInitDialog();
	CString Buff;
	APP App = (APP) AfxGetApp();
	bool bFlag;
	
	m_listUtVariables.ResetContent();
	m_listUtVariables.SetCheckStyle(BS_AUTOCHECKBOX);

	Buff.LoadString(IDS_Preamp_Gain);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Preamp_Mode);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Damping);							m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Pulse_Width);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Pulse_Voltage);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Linear_Gain);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Log_Gain);							m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Output_Mode);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Rectifier_Mode);					m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Filter_Type);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Filter_Range);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Filter_Center);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Filter_Cut_Off);					m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_DAC_Mode);							m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_DAC_Trigger);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_DAC_Delay);							m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_DAC_Threshold);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_DAC_Table);							m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Scope_Delay);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Scope_Width);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Gate_Mode);							m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Gate_Delay);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Gate_Width);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Gate_Threshold);					m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Gate_Dead_Zone);					m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Gate_Peak_Width);					m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_Amplitude_Collect);					m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_TOF_Collect);						m_listUtVariables.AddString(Buff);
	Buff.LoadString(IDS_TOF_Mode);							m_listUtVariables.AddString(Buff);

	App->m_LastSettings.n64CopyUtVariable & _UT_PREAMP_GAIN ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(0,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_PREAMP_MODE ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(1,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_DAMPING ? bFlag = true : bFlag = false;			m_listUtVariables.SetCheck(2,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_PULSE_WIDTH ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(3,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_PULSE_VOLTAGE ? bFlag = true : bFlag = false;	m_listUtVariables.SetCheck(4,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_LINEAR_GAIN ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(5,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_LOG_GAIN ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(6,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_OUTPUT_MODE ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(7,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_RECTIFY_MODE ? bFlag = true : bFlag = false;	m_listUtVariables.SetCheck(8,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_FILTER_TYPE ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(9,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_FILTER_RANGE ? bFlag = true : bFlag = false;	m_listUtVariables.SetCheck(10,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_FILTER_CENTER ? bFlag = true : bFlag = false;	m_listUtVariables.SetCheck(11,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_FILTER_CUT_OFF ? bFlag = true : bFlag = false;	m_listUtVariables.SetCheck(12,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_DAC_MODE ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(13,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_DAC_TRIGGER ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(14,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_DAC_DELAY ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(15,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_DAC_THRESHOLD ? bFlag = true : bFlag = false;	m_listUtVariables.SetCheck(16,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_DAC_TABLE ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(17,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_SCOPE_DELAY ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(18,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_SCOPE_WIDTH ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(19,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_GATE_MODE ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(20,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_GATE_DELAY ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(21,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_GATE_WIDTH ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(22,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_GATE_THRESHOLD ? bFlag = true : bFlag = false;	m_listUtVariables.SetCheck(23,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_GATE_FAR_DEAD_ZONE ? bFlag = true : bFlag = false;	m_listUtVariables.SetCheck(24,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_GATE_FAR_PEAK_WIDTH ? bFlag = true : bFlag = false;	m_listUtVariables.SetCheck(25,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_AMPLITUDE_COLLECT ? bFlag = true : bFlag = false;	m_listUtVariables.SetCheck(26,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_TOF_COLLECT ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(27,bFlag);
	App->m_LastSettings.n64CopyUtVariable & _UT_TOF_MODE ? bFlag = true : bFlag = false;		m_listUtVariables.SetCheck(28,bFlag);

	m_bDlgCreated = true;
	
	return TRUE;  // return TRUE unless you set the focus to a control
	              // EXCEPTION: OCX Property Pages should return FALSE
}

BOOL CCopyUtPage::OnSetActive() 
{
	APP App = (APP)AfxGetApp();
	App->m_LastSettings.nLastCustomizeTab = ((CPropertySheet*)GetParent())->GetActiveIndex();
	
	return CPropertyPage::OnSetActive();
}

void CCopyUtPage::OnSelchangeListUtVariables() 
{

}

void CCopyUtPage::OnCheckChangeListUtVariables() 
{
	APP App = (APP)AfxGetApp();

	App->m_LastSettings.n64CopyUtVariable = 0;
	if(m_listUtVariables.GetCheck(0)) App->m_LastSettings.n64CopyUtVariable |= _UT_PREAMP_GAIN;	
	if(m_listUtVariables.GetCheck(1)) App->m_LastSettings.n64CopyUtVariable |= _UT_PREAMP_MODE;	
	if(m_listUtVariables.GetCheck(2)) App->m_LastSettings.n64CopyUtVariable |= _UT_DAMPING;	
	if(m_listUtVariables.GetCheck(3)) App->m_LastSettings.n64CopyUtVariable |= _UT_PULSE_WIDTH;	
	if(m_listUtVariables.GetCheck(4)) App->m_LastSettings.n64CopyUtVariable |= _UT_PULSE_VOLTAGE;	
	if(m_listUtVariables.GetCheck(5)) App->m_LastSettings.n64CopyUtVariable |= _UT_LINEAR_GAIN;	
	if(m_listUtVariables.GetCheck(6)) App->m_LastSettings.n64CopyUtVariable |= _UT_LOG_GAIN;	
	if(m_listUtVariables.GetCheck(7)) App->m_LastSettings.n64CopyUtVariable |= _UT_OUTPUT_MODE;	
	if(m_listUtVariables.GetCheck(8)) App->m_LastSettings.n64CopyUtVariable |= _UT_RECTIFY_MODE;	
	if(m_listUtVariables.GetCheck(9)) App->m_LastSettings.n64CopyUtVariable |= _UT_FILTER_TYPE;	
	if(m_listUtVariables.GetCheck(10)) App->m_LastSettings.n64CopyUtVariable |= _UT_FILTER_RANGE;	
	if(m_listUtVariables.GetCheck(11)) App->m_LastSettings.n64CopyUtVariable |= _UT_FILTER_CENTER;	
	if(m_listUtVariables.GetCheck(12)) App->m_LastSettings.n64CopyUtVariable |= _UT_FILTER_CUT_OFF;
	if(m_listUtVariables.GetCheck(13)) App->m_LastSettings.n64CopyUtVariable |=	_UT_DAC_MODE;
	if(m_listUtVariables.GetCheck(14)) App->m_LastSettings.n64CopyUtVariable |=	_UT_DAC_TRIGGER;
	if(m_listUtVariables.GetCheck(15)) App->m_LastSettings.n64CopyUtVariable |=	_UT_DAC_DELAY;
	if(m_listUtVariables.GetCheck(16)) App->m_LastSettings.n64CopyUtVariable |=	_UT_DAC_THRESHOLD;
	if(m_listUtVariables.GetCheck(17)) App->m_LastSettings.n64CopyUtVariable |=	_UT_DAC_TABLE;
	if(m_listUtVariables.GetCheck(18)) App->m_LastSettings.n64CopyUtVariable |=	_UT_SCOPE_DELAY;
	if(m_listUtVariables.GetCheck(19)) App->m_LastSettings.n64CopyUtVariable |=	_UT_SCOPE_WIDTH;
	if(m_listUtVariables.GetCheck(20)) App->m_LastSettings.n64CopyUtVariable |=	_UT_GATE_MODE;
	if(m_listUtVariables.GetCheck(21)) App->m_LastSettings.n64CopyUtVariable |=	_UT_GATE_DELAY;
	if(m_listUtVariables.GetCheck(22)) App->m_LastSettings.n64CopyUtVariable |=	_UT_GATE_WIDTH;
	if(m_listUtVariables.GetCheck(23)) App->m_LastSettings.n64CopyUtVariable |=	_UT_GATE_THRESHOLD;
	if(m_listUtVariables.GetCheck(24)) App->m_LastSettings.n64CopyUtVariable |=	_UT_GATE_FAR_DEAD_ZONE;
	if(m_listUtVariables.GetCheck(25)) App->m_LastSettings.n64CopyUtVariable |=	_UT_GATE_FAR_PEAK_WIDTH;
	if(m_listUtVariables.GetCheck(26)) App->m_LastSettings.n64CopyUtVariable |=	_UT_AMPLITUDE_COLLECT;
	if(m_listUtVariables.GetCheck(27)) App->m_LastSettings.n64CopyUtVariable |=	_UT_TOF_COLLECT;
	if(m_listUtVariables.GetCheck(28)) App->m_LastSettings.n64CopyUtVariable |=	_UT_TOF_MODE;


}
